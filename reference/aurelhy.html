<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create an 'aurelhy' object that contains required data to perform AURELHY interpolation — aurelhy • aurelhy</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="152x152" href="../apple-touch-icon-152x152.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- svPkgdown --><script src="../script.js"></script><!-- themify icon --><link rel="stylesheet" href="../themify-icons.css?nocache=123"><!--<link rel="stylesheet" href="../style.css?nocache=123">--><!-- bootstrat v4.1.1, required CSS from more recent version --><link rel="stylesheet" href="../bootstrap.more.css?nocache=123"><link href="../style.css?nocache=123" rel="stylesheet"><!-- end of addition for svPkgdown --><meta property="og:title" content="Create an 'aurelhy' object that contains required data to perform AURELHY interpolation — aurelhy"><meta property="og:description" content="An 'aurelhy' object contains principal components calculated after the various variables describing the landscape,
  as well as other useful descriptors. Use the predict() method to interpolate some data with the AURELHY method."><meta property="og:image" content="https://www.sciviews.org/aurelhy/logo.png"><meta name="twitter:card" content="summary"><!-- Mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js" async integrity="sha256-nlrDrBTHxJJlDDX22AS33xYI1OJHnGMDhiYMSe2U0e0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/config/TeX-AMS-MML_HTMLorMML.js" async integrity="sha256-4zys9A4hMQmtq2EUL+JRoXc0NZi8jVJMzb8onewOaSQ=" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><!--<script async src="https://www.googletagmanager.com/gtag/js?id=UA-462421-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-462421-8');
</script>--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><!-- preloader start --><div class="preloader">
  <img src="../preloader.gif" alt="loading..."></div>
<!-- preloader end -->

<div class="navbar navbar-default navbar-fixed-top bg-secondary" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="navbar-brand-container">
       <div class="navbar-brand-logo">
         <a class="external-link navbar-brand" href="https://www.sciviews.org">
          <img src="../logo_full.png" alt="SciViews"></a>
       </div>
       <div class="navbar-brand-package">
      </div>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <!-- start svPkgdown global site search with Google -->
      <form action="https://www.google.com/search" class="navbar-form navbar-right search-form-global">
        <div class="form-group has-search">
          <span class="fa fa-search form-control-feedback-global"></span>
          <input type="text" class="form-control-global search-form-input" name="q" id="q" placeholder="Search..." required><input type="hidden" name="sitesearch" value="https://www.sciviews.org"></div>
      </form>
      <!-- end svPkgdown global site search with Google -->
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/aurelhy.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/SciViews/aurelhy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul><div class="navbar-title">
        <a class="navbar-brand" href="../index.html"><p class="h2">aurelhy <small>v1.1.0</small></p></a>
      </div>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
  <div class="navbar-spacer bg-light">
  </div>
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an 'aurelhy' object that contains required data to perform AURELHY interpolation</h1>

    <div class="hidden name"><code>aurelhy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An 'aurelhy' object contains principal components calculated after the various variables describing the landscape,
  as well as other useful descriptors. Use the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method to interpolate some data with the AURELHY method.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aurelhy</span><span class="op">(</span><span class="va">geotm</span>, <span class="va">geomask</span>, landmask <span class="op">=</span> <span class="fu"><a href="auremask.html">auremask</a></span><span class="op">(</span><span class="op">)</span>, x0 <span class="op">=</span> <span class="fl">30</span>, y0 <span class="op">=</span> <span class="fl">30</span>, step <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    nbr.pc <span class="op">=</span> <span class="fl">10</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, model <span class="op">=</span> <span class="st">"data ~ ."</span>, vgmodel <span class="op">=</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/gstat/reference/vgm.html" class="external-link">vgm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Sph"</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    add.vars <span class="op">=</span> <span class="cn">NULL</span>, var.name <span class="op">=</span> <span class="cn">NULL</span>, resample.geomask <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, main <span class="op">=</span> <span class="st">"PCA on land descriptors"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x</span>, pch <span class="op">=</span> <span class="st">"."</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">nbr.pc</span>, <span class="va">scale</span>, <span class="va">model</span>, <span class="va">vgmodel</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">geopoints</span>, <span class="va">variable</span>, v.fit <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'predict.aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'predict.aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'predict.aurelhy'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, which <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'aurelhy'</span></span>
<span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">x</span>, what <span class="op">=</span> <span class="st">"PC1"</span>, nodata <span class="op">=</span> <span class="cn">NA</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'predict.aurelhy'</span></span>
<span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>    what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Interpolated"</span>, <span class="st">"Predicted"</span>, <span class="st">"KrigedResiduals"</span>, <span class="st">"KrigeVariance"</span><span class="op">)</span>,</span>
<span>  nodata <span class="op">=</span> <span class="cn">NA</span>,<span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-geotm">geotm<a class="anchor" aria-label="anchor" href="#arg-geotm"></a></dt>
<dd><p>a terrain model ('geotm' object) with enough resolution to be
    able to calculate all landscape descriptors (use <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> or
    <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods of an 'auremask' object used to calculate landscape
    descriptors to check your terrain model is dense enough).</p></dd>

  <dt id="arg-geomask">geomask<a class="anchor" aria-label="anchor" href="#arg-geomask"></a></dt>
<dd><p>a 'geomask' object with same resolution and coverage of the
    'geotm' object or the final interpolation grid (with <code>resample.geomask = FALSE</code>),
    and indicating which points should be considered for the interpolation (note
    that your terrain model must be larger than the targetted area by, at least,
    maximum distance of the mask in all directions in order to be able to
    calculate landscape descriptors for all considered points).</p></dd>

  <dt id="arg-landmask">landmask<a class="anchor" aria-label="anchor" href="#arg-landmask"></a></dt>
<dd><p>an 'auremask' object that defines the window of analysis used
    around each point ot calculate its landscape descriptors.</p></dd>

  <dt id="arg-x-">x0<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p>shift in X direction (longitude) where to consider the first
    point of the interpolation grid (note that interpolation grid must be less
    dense or equal to the terrain model grid, depending on the mask used).</p></dd>

  <dt id="arg-y-">y0<a class="anchor" aria-label="anchor" href="#arg-y-"></a></dt>
<dd><p>shift in Y direction (latitude) for the first point of the
    interpolation grid.</p></dd>

  <dt id="arg-step">step<a class="anchor" aria-label="anchor" href="#arg-step"></a></dt>
<dd><p>resolution of the interpolation grid, i.e., we keep one point
    every <code>step</code> points from the original grid of the terrain model for
    constructing the interpolation grid. <code>step</code> must be a single integer
    larger or equal to one (may be equal to one only with rectangular 'auremask'
    objects).</p></dd>

  <dt id="arg-nbr-pc">nbr.pc<a class="anchor" aria-label="anchor" href="#arg-nbr-pc"></a></dt>
<dd><p>number of PCA's principal components to keep in the
    interpolation. This is the initial value; the example show you how you can
    change this after the 'aurelhy' object is calculated.</p></dd>

  <dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>should we scale the landscape descriptors (variance = 1) before
    performing the PCA? If <code>scale = FALSE</code> (by default), a PCA is run on
    the variance-covariance matrix (no scaling), otherwise, the PCA is run on
    the correlation matrix.</p></dd>

  <dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a formula describing the model used to predict the data. The
    left-hand side of the formula must always be 'data' and the right-hand
    considers all predictors separated by a plus sign. To use all predictors,
    specify <code>data ~ .</code> (by default).</p></dd>

  <dt id="arg-vgmodel">vgmodel<a class="anchor" aria-label="anchor" href="#arg-vgmodel"></a></dt>
<dd><p>the variogram model to fit, as defined by the <code><a href="https://r-spatial.github.io/gstat/reference/vgm.html" class="external-link">gstat::vgm()</a></code>
    function of the gstat package</p></dd>

  <dt id="arg-add-vars">add.vars<a class="anchor" aria-label="anchor" href="#arg-add-vars"></a></dt>
<dd><p>additional variable(s) measured at the same points as the
    geotm object, or the final interpolation grid. They will be used as
    additional predictors. The example show you how you can add or remove such
    variables after the 'aurelhy' object is calculated. If <code>NULL</code> (by
    default), no additional variables will be used.</p></dd>

  <dt id="arg-var-name">var.name<a class="anchor" aria-label="anchor" href="#arg-var-name"></a></dt>
<dd><p>if <code>add.vars</code> is a 'geomat' object, you can give the
    name you want to use for this predictor here.</p></dd>

  <dt id="arg-resample-geomask">resample.geomask<a class="anchor" aria-label="anchor" href="#arg-resample-geomask"></a></dt>
<dd><p>do we resample the geomask using <code>x0</code>, <code>y0</code>
    and <code>step</code> to get the final mask of calculated points? If <code>TRUE</code>
    (by default), geomask should have the same grid as geotm. Otherwise, the
    geomask must exactly match the points where aurelhy should perform the
    interpolation. The default value allows for a backward-compatible behavior
    of the function (aurelhy version =&lt; 1.0-2).</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an 'aurelhy' or 'predict.aurelhy' object, depending on the method invoked</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a 'geopoints' object to create a plot best depicting the
    interpolation process, or nothing to just plot the interpolation grid.</p></dd>

  <dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>the main title of the graph</p></dd>

  <dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>the symbol to use for plotting points. The default value,
    <code>pch = "."</code> prints a small (usually one pixel size) square</p></dd>

  <dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an 'aurelhy' object</p></dd>

  <dt id="arg-geopoints">geopoints<a class="anchor" aria-label="anchor" href="#arg-geopoints"></a></dt>
<dd><p>a 'geopoints' object with data to be interpolated.</p></dd>

  <dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>the name of the variable in the 'geopoints' object to interpolate</p></dd>

  <dt id="arg-v-fit">v.fit<a class="anchor" aria-label="anchor" href="#arg-v-fit"></a></dt>
<dd><p>the fitted variogram model used to krige residuals. If <code>NULL</code>
    (by default), a fitted model for the variogram is calculated, starting from the
    model provided in the 'aurelhy' object, 'vgm' slot. If <code>FALSE</code>, residuals
    are not kriged (useful, e.g., to save calculation time when one look for
    best predictors in the regression)</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>which graph to plot</p></dd>

  <dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>what is extracted as a 'geomat' object</p></dd>

  <dt id="arg-nodata">nodata<a class="anchor" aria-label="anchor" href="#arg-nodata"></a></dt>
<dd><p>the code used to represent missing data in the 'geomat' object</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to the function</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>aurelhy()</code> creates a new 'aurelhy' object. The object has <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
  and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods for further diagnostics. You should use the
  <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method to perform the AURELHY interpolation on some data. The
  'aurelhy' object is also easy to save for further reuse (it is designed so
  that the most time-consumming operations are done during its creation; so, it
  is supposed to be generated only once and reused for different interpolations
  on the same terrain model).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>An 'aurelhy' object with all information required to perform an AURELHY
  interpolation with any 'geopoints' data.</p>
    </div>
    <div id="source">
    <h2>Source</h2>
    <p>Benichou P, Le Breton O (1987). Prise en compte de la topographie pour la
  cartographie des champs pluviometriques statistiques. La Meteorologie, 7:23-34.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Philippe Grosjean &lt;phgrosjean@sciviews.org&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="geomat.html">geotm</a></code>, <code><a href="auremask.html">auremask</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create an aurelhy object for the Morocco terrain data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">morocco</span><span class="op">)</span>  <span class="co"># The terrain model with a grid of about 924x924m</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mbord</span><span class="op">)</span>    <span class="co"># A shape with the area around Morocco to analyze</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mmask</span><span class="op">)</span>    <span class="co"># A 924x924m grid with a mask covering territory to analyze</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mseadist</span><span class="op">)</span> <span class="co"># The distance to the sea for territory to analyze</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mrain</span><span class="op">)</span>    <span class="co"># Rain data measured at 43 stations to be interpolated</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a map with these data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">morocco</span><span class="op">)</span> <span class="co"># Plot the terrain model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mbord</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># Add borders of territory to analyze in red</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sure we use all the stations from mrain in the geomask</span></span></span>
<span class="r-in"><span><span class="va">mmask2</span> <span class="op">&lt;-</span> <span class="fu"><a href="utilities.html">add.points</a></span><span class="op">(</span><span class="va">mmask</span>, <span class="va">mrain</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now, create an aurelhy object with landscape description, using the</span></span></span>
<span class="r-in"><span><span class="co"># first ten PCs, plus the distance to the sea (mseadist) for prediction</span></span></span>
<span class="r-in"><span><span class="co"># Use a default radial window of analysis of 26km as maximum distance</span></span></span>
<span class="r-in"><span><span class="co"># and an interpolation grid of 0.1x0.1degrees (roughly 11x11km)</span></span></span>
<span class="r-in"><span><span class="co"># The variogram model is kept simple here, see ?gstat::vgm for other choices</span></span></span>
<span class="r-in"><span><span class="co"># Be patient... this takes a little time to calculate!</span></span></span>
<span class="r-in"><span><span class="va">maurelhy</span> <span class="op">&lt;-</span> <span class="fu">aurelhy</span><span class="op">(</span><span class="va">morocco</span>, <span class="va">mmask2</span>, <span class="fu"><a href="auremask.html">auremask</a></span><span class="op">(</span><span class="op">)</span>, x0 <span class="op">=</span> <span class="fl">30</span>, y0 <span class="op">=</span> <span class="fl">54</span>, step <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>    scale <span class="op">=</span> <span class="cn">TRUE</span>, nbr.pc <span class="op">=</span> <span class="fl">10</span>, vgmodel <span class="op">=</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/gstat/reference/vgm.html" class="external-link">vgm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"Sph"</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    add.vars <span class="op">=</span> <span class="va">mseadist</span>, var.name <span class="op">=</span> <span class="st">"seadist"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maurelhy</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An aurelhy object to interpolate points in a terrain model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A geotm object with a grid of 160 x 150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The cell size is 0.1°, that is approx. 11090 m in lat.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The grid spans from -17.05241° to -1.052414° long.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            and from 20.94464° to 35.94464° lat.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data are of type integer </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Keeping 10 PCs from a PCA on scaled data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictive variables are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x, y, z, PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8, PC9, PC10, seadist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression model is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data ~ .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5610cdd2b790&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variogram model is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Nug     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Sph   100     1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">maurelhy</span><span class="op">)</span> <span class="co"># Add the interpolated points on the map</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">mrain</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># Add location of weather stations in red</span></span></span>
<span class="r-plt img"><img src="aurelhy-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Diagnostic of the PCA on land descriptors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">maurelhy</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC1    PC2     PC3     PC4     PC5     PC6     PC7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     4.2563 3.0000 1.91585 1.46404 1.11425 0.87457 0.84459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.4529 0.2250 0.09176 0.05359 0.03104 0.01912 0.01783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.4529 0.6779 0.76965 0.82324 0.85428 0.87340 0.89123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            PC8     PC9   PC10    PC11    PC12    PC13    PC14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     0.78604 0.68606 0.5899 0.57771 0.53711 0.53056 0.47875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.01545 0.01177 0.0087 0.00834 0.00721 0.00704 0.00573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.90668 0.91844 0.9271 0.93549 0.94270 0.94974 0.95547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC15    PC16    PC17    PC18    PC19    PC20    PC21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     0.42054 0.39558 0.38199 0.36180 0.34447 0.32917 0.31865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.00442 0.00391 0.00365 0.00327 0.00297 0.00271 0.00254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.95989 0.96380 0.96745 0.97072 0.97369 0.97640 0.97893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC22    PC23    PC24    PC25    PC26    PC27   PC28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     0.30930 0.29722 0.27640 0.27298 0.24637 0.23710 0.2278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.00239 0.00221 0.00191 0.00186 0.00152 0.00141 0.0013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.98133 0.98353 0.98544 0.98731 0.98882 0.99023 0.9915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC29    PC30    PC31   PC32    PC33    PC34    PC35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     0.21778 0.20592 0.19651 0.1898 0.17331 0.17147 0.15369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.00119 0.00106 0.00097 0.0009 0.00075 0.00074 0.00059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.99271 0.99377 0.99474 0.9956 0.99639 0.99712 0.99771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC36   PC37    PC38    PC39    PC40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     0.14557 0.1411 0.13678 0.12871 0.12266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance 0.00053 0.0005 0.00047 0.00041 0.00038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion  0.99824 0.9987 0.99921 0.99962 1.00000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maurelhy</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interpolate 'rain' variable on the considered territory around Morocco</span></span></span>
<span class="r-in"><span><span class="co"># Since we do not want negative values for this variable and it is log-normally</span></span></span>
<span class="r-in"><span><span class="co"># distributed, we will interpolate log10(rain) instead</span></span></span>
<span class="r-in"><span><span class="va">mrain</span><span class="op">$</span><span class="va">logRain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">mrain</span><span class="op">$</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pmrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">maurelhy</span>, <span class="va">mrain</span>, <span class="st">"logRain"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [adjusted R-squared is 0.956]</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>singular model in variogram fit</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>singular model in variogram fit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using universal kriging]</span>
<span class="r-in"><span><span class="va">pmrain</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A predict.aurelhy object with interpolated values for variable 'logRain':</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictive variables are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x, y, z, PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8, PC9, PC10, seadist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression model (adjusted R-squared = 0.956) is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data ~ .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5610cdd2b790&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predicted values are distributed as follows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.6683  1.5565  1.9224  1.9466  2.3983  3.5737 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals on provided predictors are distributed as follows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.128673 -0.023575 -0.002434  0.000000  0.032716  0.138138 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variogram model for universal kriging of the residuals is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model       psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Nug 0.003079182     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Sph 0.000000000     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kriged residuals are distributed as follows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1287  0.0000  0.0000  0.0000  0.0000  0.1381 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interpolated values for 'logRain' are distributed as follows:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.6683  1.5565  1.9224  1.9466  2.3981  3.5737 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Diagnostic of regression model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pmrain</span><span class="op">)</span> <span class="co"># Significant predictors at alpha = 0.01 are x, y, PC3, PC6 and PC7</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = model, data = pred)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.128673 -0.023575 -0.002434  0.032716  0.138138 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -3.6776234  0.6312486  -5.826 5.24e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x           -0.0658202  0.0172210  -3.822 0.000825 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y            0.1722831  0.0152375  11.307 4.24e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z            0.0001586  0.0001041   1.524 0.140537    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC1          0.0128963  0.0102958   1.253 0.222427    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC2          0.0086366  0.0075729   1.140 0.265346    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC3         -0.0289542  0.0099024  -2.924 0.007429 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC4          0.0161374  0.0127922   1.262 0.219251    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC5          0.0252028  0.0333368   0.756 0.457003    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC6         -0.0753527  0.0228541  -3.297 0.003033 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC7         -0.0783908  0.0228653  -3.428 0.002199 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC8         -0.0301338  0.0202521  -1.488 0.149791    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC9         -0.0035077  0.0335837  -0.104 0.917684    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC10         0.0064643  0.0507897   0.127 0.899782    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> seadist     -0.0004648  0.0003808  -1.221 0.234126    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.06767 on 24 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9724,	Adjusted R-squared:  0.9563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 60.35 on 14 and 24 DF,  p-value: 3.134e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># one could simplify the model as data ~ x + y + PC3 + PC6 + PC7</span></span></span>
<span class="r-in"><span><span class="co"># but it is faster to keep the full model for final interpolation</span></span></span>
<span class="r-in"><span><span class="co"># when we are only interested by the final interpolation or when processing</span></span></span>
<span class="r-in"><span><span class="co"># is automated...</span></span></span>
<span class="r-in"><span><span class="co"># Any of the predictors can be extracted from maurelhy as a geomat object</span></span></span>
<span class="r-in"><span><span class="co"># for further inspection. For instance, let's look at PC3, PC6 and PC7 components</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">maurelhy</span>, <span class="st">"PC3"</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">maurelhy</span>, <span class="st">"PC6"</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">maurelhy</span>, <span class="st">"PC7"</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Residuals versus fitted (how residuals spread?)</span></span></span>
<span class="r-plt img"><img src="aurelhy-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Normal Q-Q plot of residuals (residuals distribution)</span></span></span>
<span class="r-plt img"><img src="aurelhy-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># Best graph to look at residuals homoscedasticity</span></span></span>
<span class="r-plt img"><img src="aurelhy-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># Cook's distance of residuals versus observation</span></span></span>
<span class="r-plt img"><img src="aurelhy-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># Residuals leverage: are there influencial points?</span></span></span>
<span class="r-plt img"><img src="aurelhy-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Map of predicted values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">pmrain</span>, <span class="st">"Predicted"</span><span class="op">)</span>, asp <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    color.palette <span class="op">=</span> <span class="va">terrain.colors</span>, main <span class="op">=</span> <span class="st">"Values predicted by the linear model"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Residuals kriging diagnostic</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="co"># Semi-variogram and adjusted model</span></span></span>
<span class="r-plt img"><img src="aurelhy-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">pmrain</span>, <span class="st">"KrigedResiduals"</span><span class="op">)</span>, asp <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    color.palette <span class="op">=</span> <span class="va">terrain.colors</span>, main <span class="op">=</span> <span class="st">"Kriged residuals"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">pmrain</span>, <span class="st">"KrigeVariance"</span><span class="op">)</span>, asp <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    color.palette <span class="op">=</span> <span class="va">terrain.colors</span>, main <span class="op">=</span> <span class="st">"Kriged residuals variance"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># As we can expect, kriging variance is larger in the south/south-west part</span></span></span>
<span class="r-in"><span><span class="co"># where density of stations is low</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AURELHY interpolation diagnostic plots</span></span></span>
<span class="r-in"><span><span class="co"># Graph showing the importance of predicted versus kriged residuals for</span></span></span>
<span class="r-in"><span><span class="co"># all observations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>  <span class="co"># Model prediction and kriged residuals</span></span></span>
<span class="r-plt img"><img src="aurelhy-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract interpolated log(rain) and transform back into rain (mm)</span></span></span>
<span class="r-in"><span><span class="va">geomrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="geomat.html">as.geomat</a></span><span class="op">(</span><span class="va">pmrain</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geomrain</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">geomrain</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># How is interpolated rain distributed?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">geomrain</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]    4.659288 3747.111574</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">mrain</span><span class="op">$</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  24.5 961.4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ooops! We have some very high values! How many?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">geomrain</span> <span class="op">&gt;</span> <span class="fl">1000</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 43</span>
<span class="r-in"><span><span class="co"># This is probably due to a lack of data at high altitudes</span></span></span>
<span class="r-in"><span><span class="co"># Let's truncate them to 1000 for a better graph</span></span></span>
<span class="r-in"><span><span class="va">geomrain</span><span class="op">[</span><span class="va">geomrain</span> <span class="op">&gt;</span> <span class="fl">1000</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="co"># ... and plot the result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">geomrain</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">topo.colors</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">geomrain</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mbord</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">mrain</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A better plot for these interpolated rain data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="fu"><a href="utilities.html">coords</a></span><span class="op">(</span><span class="va">geomrain</span>, <span class="st">"x"</span><span class="op">)</span>, <span class="fu"><a href="utilities.html">coords</a></span><span class="op">(</span><span class="va">geomrain</span>, <span class="st">"y"</span><span class="op">)</span>, <span class="va">geomrain</span>,</span></span>
<span class="r-in"><span>    asp <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"Longitude"</span>, ylab <span class="op">=</span> <span class="st">"Latitude"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"AURELHY interpolated rain data"</span>, key.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="st">"Rain (mm)\n\n"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    color.palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"gray"</span>, <span class="st">"blue"</span><span class="op">)</span>, bias <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># One can experiment different interpolation parameters using update()</span></span></span>
<span class="r-in"><span><span class="co"># Suppose we (1) don't want to scale PCs, (2) to keep only first 7 PCs,</span></span></span>
<span class="r-in"><span><span class="co"># (3) we want an upgraded linear model like this:</span></span></span>
<span class="r-in"><span><span class="co"># data &lt;- a.x + b.y + c.z + d.PC3 + e.PC6 + f.PC7 + g.seadist + h.seadist^2 + i</span></span></span>
<span class="r-in"><span><span class="co"># and (4) we want a Gaussian model for the semi-variogram</span></span></span>
<span class="r-in"><span><span class="co"># (note that one can also regress against seadist2 &lt;- seadist^2), just do:</span></span></span>
<span class="r-in"><span><span class="co"># maurelhy2$seadist2 &lt;- maurelhy$seadist^2</span></span></span>
<span class="r-in"><span><span class="co"># Even with all these changes, you don't have to recompute maurelhy,</span></span></span>
<span class="r-in"><span><span class="co"># just update() it and the costly steps of calculating landscape descriptors</span></span></span>
<span class="r-in"><span><span class="co"># are reused (not the use of I() to protect calcs inside a formula)!</span></span></span>
<span class="r-in"><span><span class="va">maurelhy2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">maurelhy</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, nbr.pc <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">data</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">z</span> <span class="op">+</span> <span class="va">PC3</span> <span class="op">+</span> <span class="va">PC6</span> <span class="op">+</span> <span class="va">PC7</span> <span class="op">+</span> <span class="va">seadist</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">seadist</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  vgmodel <span class="op">=</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/gstat/reference/vgm.html" class="external-link">vgm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"Gau"</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maurelhy2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An aurelhy object to interpolate points in a terrain model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A geotm object with a grid of 160 x 150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The cell size is 0.1°, that is approx. 11090 m in lat.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The grid spans from -17.05241° to -1.052414° long.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            and from 20.94464° to 35.94464° lat.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data are of type integer </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Keeping 7 PCs from a PCA on non-scaled data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictive variables are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x, y, z, seadist, PC1, PC2, PC3, PC4, PC5, PC6, PC7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression model is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data ~ x + y + z + PC3 + PC6 + PC7 + seadist + I(seadist^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5610ce70e498&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variogram model is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Nug     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Gau   100     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Diagnostic of the new PCA on land descriptors without scaling</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">maurelhy2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             PC1      PC2       PC3       PC4       PC5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     868.9669 690.4374 364.15732 278.30039 196.63042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance   0.4476   0.2826   0.07862   0.04592   0.02292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion    0.4476   0.7302   0.80887   0.85478   0.87771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              PC6       PC7       PC8       PC9      PC10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     175.24122 158.25418 135.92576 127.47496 113.50493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance   0.01821   0.01485   0.01095   0.00963   0.00764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion    0.89591   0.91076   0.92171   0.93134   0.93898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             PC11     PC12     PC13     PC14     PC15     PC16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     105.68148 99.55289 93.84086 88.79213 84.07756 79.75201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance   0.00662  0.00588  0.00522  0.00467  0.00419  0.00377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion    0.94560  0.95148  0.95670  0.96137  0.96556  0.96933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            PC17     PC18     PC19     PC20    PC21     PC22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     74.05424 69.64528 65.27751 61.57131 58.0412 55.79096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.00325  0.00288  0.00253  0.00225  0.0020  0.00185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.97259  0.97546  0.97799  0.98023  0.9822  0.98408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            PC23     PC24     PC25     PC26     PC27     PC28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     53.79148 52.55186 47.55454 46.60769 44.14101 43.98679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.00172  0.00164  0.00134  0.00129  0.00116  0.00115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.98579  0.98743  0.98877  0.99006  0.99121  0.99236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           PC29     PC30     PC31     PC32     PC33    PC34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     41.0182 40.84302 38.70327 36.06416 32.78410 31.7659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.0010  0.00099  0.00089  0.00077  0.00064  0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.9934  0.99435  0.99523  0.99601  0.99664  0.9972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            PC35     PC36     PC37     PC38     PC39     PC40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviation     30.80766 29.33019 28.19433 27.15936 26.14326 25.07158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion of Variance  0.00056  0.00051  0.00047  0.00044  0.00041  0.00037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative Proportion   0.99780  0.99831  0.99878  0.99922  0.99963  1.00000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maurelhy2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aurelhy-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interpolate with the new parameters</span></span></span>
<span class="r-in"><span><span class="va">pmrain2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">maurelhy2</span>, <span class="va">mrain</span>, <span class="st">"logRain"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [adjusted R-squared is 0.945]</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No convergence after 200 iterations: try different initial values?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using universal kriging]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pmrain2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = model, data = pred)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.126619 -0.043126 -0.005631  0.051824  0.124632 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -3.611e+00  4.938e-01  -7.313 3.83e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x            -6.060e-02  1.247e-02  -4.859 3.46e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y             1.710e-01  1.232e-02  13.875 1.37e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z             6.039e-05  7.530e-05   0.802  0.42883    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC3          -1.898e-04  4.074e-05  -4.659 6.09e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC6          -1.125e-04  7.451e-05  -1.510  0.14141    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC7           3.444e-04  1.386e-04   2.486  0.01872 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> seadist       1.327e-03  5.463e-04   2.429  0.02134 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(seadist^2) -4.317e-06  1.373e-06  -3.144  0.00374 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.07581 on 30 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9567,	Adjusted R-squared:  0.9451 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 82.81 on 8 and 30 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A couple of graphs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain2</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Residuals versus fitted (how residuals spread?)</span></span></span>
<span class="r-plt img"><img src="aurelhy-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain</span>, which <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="co"># Semi-variogram and adjusted model</span></span></span>
<span class="r-plt img"><img src="aurelhy-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmrain2</span>, which <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="co"># Model prediction and kriged residuals</span></span></span>
<span class="r-plt img"><img src="aurelhy-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#... Explore as much as you like until you find the set of parameters that suits you!</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><!-- footer --><!--<footer class="bg-secondary">--><div class="bg-secondary full-width">
    <div class="py-100 border-bottom" style="border-color: #454547 !important">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-4">
                    <div class="mb-5 mb-md-0 text-center text-md-left">
                        <!-- logo -->
                        <img class="mb-30" src="https://www.sciviews.org/images/logo-footer.png" alt="logo"><p class="text-white mb-30"> We build software for reproducible research with R</p>
                        <!-- social icon -->
                        <ul class="list-inline"><li class="list-inline-item">
                                <a class="external-link social-icon-outline" href="https://github.com/SciViews">
                                    <i class="ti-github"></i>
                                </a>
                            </li>

                            <li class="list-inline-item">
                                <a class="external-link social-icon-outline" href="https://twitter.com/PhilGrosjean">
                                    <i class="ti-twitter-alt"></i>
                                </a>
                            </li>

                            <li class="list-inline-item">
                                <a class="external-link social-icon-outline" href="https://www.linkedin.com/in/philippe-grosjean-5b6b29a2/">
                                    <i class="ti-linkedin"></i>
                                </a>
                            </li>

                        </ul></div>
                </div>
                <!-- footer links -->
                <div class="col-lg-2 col-md-4 col-6">
                    <p class="h4 text-white mb-4">Related</p>
                    <ul class="footer-links"><li>
                            <a href="http://econum.umons.ac.be" class="external-link">Our Lab</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/fs/en/" class="external-link">Our Faculty</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/complexys/en/" class="external-link">Complexys</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/infortech/en/" class="external-link">InforTech</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/en/" class="external-link">UMONS</a>
                        </li>

                    </ul></div>
                <!-- footer links -->
                <div class="col-lg-2 col-md-4 col-6">
                    <p class="h4 text-white mb-4">Quick Link</p>
                    <ul class="footer-links"><li>
                            <a href="https://www.sciviews.org/software/svbox" class="external-link">SciViews Box</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/software/sciviews-r" class="external-link">SciViews::R</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/software/zooimage" class="external-link">Zoo/PhytoImage</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/blog" class="external-link">Blog</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/about" class="external-link">About</a>
                        </li>

                    </ul></div>
                <!-- subscribe form -->
                <div class="col-lg-3 col-md-12 offset-lg-1">
                    <div class="mt-5 mt-lg-0 text-center text-md-left">
                             <p class="h4 mb-4 text-white">Contact Us</p>
                             <p class="text-white mb-4">Need more info?<br><a href="mailto:info@sciviews.org"><span class="text-primary">Leave us a mail...</span></a></p>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- copyright -->
    <div class="pt-4 pb-3 position-relative">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-md-5">
                    <p class="text-white text-center text-md-left">
                        <span class="text-primary">SciViews</span> © All Right Reserved</p>
                </div>
                <div class="col-lg-6 col-md-7">
                    <ul class="list-inline text-center text-md-right"><li class="list-inline-item mx-lg-3 my-lg-0 mx-2 my-2">
                            <a class="external-link font-secondary text-white" href="https://creativecommons.org/licenses/by/4.0/">Site content under CC-BY 4.0 license</a>
                        </li>

                    </ul></div>
            </div>
        </div>
        <!-- back to top -->
        <!--<button class="back-to-top">
            <i class="ti-angle-up"></i>
        </button>-->
    </div>
</div>
<!--</footer>-->
<!-- /footer -->

      </footer></div>






  </body></html>

